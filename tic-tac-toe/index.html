<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Tic-Tac-Toe - Okishima</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@800&display=swap" rel="stylesheet">
<link rel="stylesheet" href="style.css">
</head>
<body>

<!-- 1. Start -->
<div class="screen active" id="screen-start">
  <button class="screen-gear-btn" onclick="togglePause()">
    <svg width="22" height="22" viewBox="0 0 24 24" fill="currentColor"><path d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58a.49.49 0 00.12-.61l-1.92-3.32a.49.49 0 00-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54a.48.48 0 00-.48-.41h-3.84a.48.48 0 00-.48.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96a.49.49 0 00-.59.22L2.74 8.87a.48.48 0 00.12.61l2.03 1.58c-.05.3-.07.62-.07.94s.02.64.07.94l-2.03 1.58a.49.49 0 00-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.26.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6A3.6 3.6 0 1115.6 12 3.61 3.61 0 0112 15.6z"/></svg>
  </button>
  <div class="preview-board">
    <div class="preview-cell">X</div>
    <div class="preview-cell"></div>
    <div class="preview-cell">O</div>
    <div class="preview-cell"></div>
    <div class="preview-cell">X</div>
    <div class="preview-cell"></div>
    <div class="preview-cell">O</div>
    <div class="preview-cell"></div>
    <div class="preview-cell">X</div>
  </div>
  <div class="logo">Tic-Tac-Toe</div>
  <div class="logo-sub">3つ並べたら勝ち</div>
  <button class="start-play-btn" onclick="showScreen('screen-mode')">START</button>
  <button class="back-btn" onclick="showRules()">あそびかた</button>
  <a href="../" class="back-btn">おわる</a>
</div>

<!-- 2. Mode select -->
<div class="screen" id="screen-mode">
  <div class="menu-title">モードをえらぶ</div>
  <div class="menu-list">
    <button class="menu-btn" onclick="startGame('cpu')">
      <span class="icon">🤖</span>
      <span>
        <span class="label-main">ひとりで遊ぶ</span>
        <span class="label-sub">CPUと対戦</span>
      </span>
    </button>
    <button class="menu-btn" onclick="startGame('human')">
      <span class="icon">👥</span>
      <span>
        <span class="label-main">ふたりで遊ぶ</span>
        <span class="label-sub">交互に入力</span>
      </span>
    </button>
  </div>
  <button class="back-btn" onclick="showScreen('screen-start')">&larr; もどる</button>
</div>

<!-- 3. Game -->
<div class="screen" id="screen-game">
  <div class="header">
    <div class="timer" id="timer">0s</div>
    <h1>Tic-Tac-Toe</h1>
    <button class="gear-btn" onclick="togglePause()">
      <svg width="22" height="22" viewBox="0 0 24 24" fill="currentColor"><path d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58a.49.49 0 00.12-.61l-1.92-3.32a.49.49 0 00-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54a.48.48 0 00-.48-.41h-3.84a.48.48 0 00-.48.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96a.49.49 0 00-.59.22L2.74 8.87a.48.48 0 00.12.61l2.03 1.58c-.05.3-.07.62-.07.94s.02.64.07.94l-2.03 1.58a.49.49 0 00-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.26.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6A3.6 3.6 0 1115.6 12 3.61 3.61 0 0112 15.6z"/></svg>
    </button>
  </div>
  <div class="game-body">
    <div class="mode-label" id="mode-label">vs CPU</div>
    <div class="level-indicator" id="level-indicator">Lv.1</div>
    <div class="score-board">
      <div class="score-x"><span id="score-x-label">X</span>: <span id="score-x">0</span></div>
      <div class="score-draw">引分: <span id="score-draw">0</span></div>
      <div class="score-o"><span id="score-o-label">O</span>: <span id="score-o">0</span></div>
    </div>
    <div class="status" id="status">
      <span class="mark-x">X</span> の番です
    </div>
    <div class="card-selector" id="card-selector">
      <div class="card-btn" data-card="normal">
        <span class="card-icon">🃏</span><span class="card-count" id="card-normal">5</span>
      </div>
      <div class="card-btn" data-card="super">
        <span class="card-icon">⚡</span><span class="card-count" id="card-super">1</span>
      </div>
      <div class="card-btn" data-card="ultra">
        <span class="card-icon">🔥</span><span class="card-count" id="card-ultra">1</span>
      </div>
    </div>
    <div class="board" id="board"></div>
  </div>
</div>

<!-- Pause overlay -->
<div class="pause-overlay" id="pause-overlay" onclick="togglePause()">
  <div class="pause-menu" onclick="event.stopPropagation()">
    <div class="pause-menu-title">メニュー</div>
    <button class="pause-item game-only" id="pause-close-btn" onclick="togglePause()">
      <span class="p-icon">▶</span>つづける
    </button>
    <div class="pause-divider game-only"></div>
    <button class="pause-item game-only" onclick="pauseRestart()">
      <span class="p-icon">🔄</span>最初から
    </button>
    <button class="pause-item game-only" onclick="pauseModeSelect()">
      <span class="p-icon">🎮</span>モード選択
    </button>
    <button class="pause-item" onclick="toggleSound()">
      <span class="p-icon" id="sound-icon">🔊</span><span id="sound-label">音量 ON</span>
    </button>
    <button class="pause-item" onclick="toggleHaptic()">
      <span class="p-icon" id="haptic-icon">📳</span><span id="haptic-label">振動 ON</span>
    </button>
    <button class="pause-item" onclick="showAbout()">
      <span class="p-icon">ℹ️</span>アプリについて
    </button>
    <div class="pause-divider"></div>
    <button class="pause-item danger" onclick="confirmReset()">
      <span class="p-icon">🗑️</span>データ初期化
    </button>
    <a class="pause-item danger" href="../">
      <span class="p-icon">🚪</span>おわる
    </a>
  </div>
</div>

<!-- Reset confirm overlay -->
<div class="confirm-overlay" id="confirm-overlay">
  <div class="confirm-box">
    <div class="confirm-text">本当に初期化しますか？<br>経験値・戦績がすべて消えます</div>
    <div class="confirm-actions">
      <button class="confirm-btn confirm-yes" onclick="executeReset()">はい</button>
      <button class="confirm-btn confirm-no" onclick="cancelReset()">いいえ</button>
    </div>
  </div>
</div>

<!-- 4. Result -->
<div class="screen" id="screen-result">
  <div class="result-icon" id="result-icon"></div>
  <div class="result-text" id="result-text"></div>
  <div class="result-time" id="result-time"></div>
  <div class="result-score">
    <div class="rx"><span id="rs-x-label">X</span>: <span id="rs-x">0</span></div>
    <div class="rd">引分: <span id="rs-draw">0</span></div>
    <div class="ro"><span id="rs-o-label">O</span>: <span id="rs-o">0</span></div>
  </div>
  <div class="level-section" id="level-section">
    <div class="result-xp" id="result-xp"></div>
    <div class="result-bonus" id="result-bonus"></div>
    <div class="level-display">
      <span class="level-label">LEVEL</span>
      <span class="level-num" id="result-level">1</span>
    </div>
    <div class="level-bar-wrap">
      <div class="level-bar" id="result-bar"></div>
    </div>
    <div class="level-info" id="result-info"></div>
    <div class="level-record" id="result-record"></div>
  </div>
  <div class="result-actions">
    <button class="result-btn result-btn-continue" onclick="continueGame()">つづける</button>
    <button class="result-btn result-btn-quit" onclick="showScreen('screen-start')">TOPに戻る</button>
  </div>
</div>

<!-- Boss intro overlay -->
<div class="boss-intro-overlay" id="boss-intro-overlay">
  <div class="boss-intro-icon">👹</div>
  <div class="boss-intro-text">BOSS 登場</div>
  <div class="boss-intro-level" id="boss-intro-level">Lv.21</div>
</div>

<!-- Coin toss overlay -->
<div class="coin-toss-overlay" id="coin-toss-overlay">
  <div class="coin-toss-label" id="coin-toss-label">コイントス...</div>
  <div class="coin">
    <div class="coin-inner" id="coin-inner">
      <div class="coin-face coin-front">X</div>
      <div class="coin-face coin-back">O</div>
    </div>
  </div>
  <div class="coin-result" id="coin-result"></div>
</div>

<!-- Card popup overlay -->
<div class="card-popup-overlay" id="card-popup-overlay" onclick="hideCardPopup()">
  <div class="card-popup" onclick="event.stopPropagation()">
    <div class="card-popup-title">カードをえらぶ</div>
    <div class="card-popup-options" id="card-popup-options"></div>
  </div>
</div>

<!-- Rules overlay -->
<div class="info-overlay" id="rules-overlay">
  <div class="info-box">
    <div class="info-title">あそびかた</div>
    <div class="info-body">
      <p>3x3 のマスに交互にマークを置き、<strong>先に3つ並べた方が勝ち</strong>です。</p>
      <div class="info-section-title">カードについて</div>
      <div class="info-card-row">
        <span class="info-card-icon">🃏</span>
        <div><strong>ノーマル</strong>（各3枚）<br>空きマスに置けます</div>
      </div>
      <div class="info-card-row">
        <span class="info-card-icon">⚡</span>
        <div><strong>スーパー</strong>（各1枚）<br>どこでも置けます。ただし⚡/🔥のマスには置けません</div>
      </div>
      <div class="info-card-row">
        <span class="info-card-icon">🔥</span>
        <div><strong>ウルトラ</strong>（各1枚）<br>マークがあるマスに上書きできます。置いたマスは⚡で上書きされなくなります</div>
      </div>
      <p class="info-note">カードは毎ラウンドリセットされます</p>
    </div>
    <button class="info-close-btn" onclick="hideRules()">とじる</button>
  </div>
</div>

<!-- About overlay -->
<div class="info-overlay" id="about-overlay">
  <div class="info-box">
    <div class="info-title">アプリについて</div>
    <div class="info-body info-about">
      <div class="about-name">Tic-Tac-Toe</div>
      <div class="about-version">Version 2.0</div>
      <div class="about-creator">Created by Okishima</div>
      <div class="about-copy">&copy; 2025 Okishima. All rights reserved.</div>
    </div>
    <button class="info-close-btn" onclick="hideAbout()">とじる</button>
  </div>
</div>

<script src="app.js"></script>
</body>
</html>
